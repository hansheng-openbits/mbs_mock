{
  "accounts": [
    {
      "id": "RESERVE",
      "target_rule": "ReserveTarget",
      "type": "RESERVE"
    },
    {
      "id": "ADVANCE",
      "type": "ADVANCE"
    }
  ],
  "bonds": [
    {
      "coupon": {
        "fixed_rate": 0.0475,
        "kind": "FIXED"
      },
      "id": "ClassA1",
      "interest_rules": {
        "accrue_on": "CURRENT_BALANCE",
        "shortfall_treatment": "CARRY"
      },
      "original_balance": 150000000.0,
      "principal_rules": {
        "allocation_weight": "BALANCE",
        "distribution_type": "SEQUENTIAL"
      },
      "priority": {
        "interest": 1,
        "principal": 1
      },
      "type": "NOTE"
    },
    {
      "coupon": {
        "cap": 0.08,
        "floor": 0.0,
        "index": "SOFR_1M",
        "kind": "FLOAT",
        "margin": 0.0175
      },
      "id": "ClassA2",
      "interest_rules": {
        "accrue_on": "CURRENT_BALANCE",
        "shortfall_treatment": "CARRY"
      },
      "original_balance": 60000000.0,
      "principal_rules": {
        "allocation_weight": "BALANCE",
        "distribution_type": "SEQUENTIAL"
      },
      "priority": {
        "interest": 2,
        "principal": 2
      },
      "type": "NOTE"
    },
    {
      "coupon": {
        "kind": "VARIABLE",
        "variable_cap": "NetWAC",
        "variable_floor": "0.04"
      },
      "id": "ClassB",
      "interest_rules": {
        "accrue_on": "CURRENT_BALANCE",
        "shortfall_treatment": "CARRY"
      },
      "original_balance": 25000000.0,
      "principal_rules": {
        "allocation_weight": "BALANCE",
        "distribution_type": "SEQUENTIAL"
      },
      "priority": {
        "interest": 3,
        "principal": 3
      },
      "type": "NOTE"
    },
    {
      "coupon": {
        "kind": "WAC"
      },
      "id": "ClassIO",
      "interest_rules": {
        "accrue_on": "ORIGINAL_BALANCE",
        "shortfall_treatment": "WRITE_OFF"
      },
      "original_balance": 0.0,
      "principal_rules": {
        "allocation_weight": "FACTOR",
        "distribution_type": "CUSTOM"
      },
      "priority": {
        "interest": 4,
        "principal": 99
      },
      "type": "IO"
    },
    {
      "coupon": {
        "fixed_rate": 0.0,
        "kind": "FIXED"
      },
      "id": "ClassR",
      "interest_rules": {
        "accrue_on": "CURRENT_BALANCE",
        "shortfall_treatment": "CARRY"
      },
      "original_balance": 15000000.0,
      "principal_rules": {
        "allocation_weight": "BALANCE",
        "distribution_type": "CUSTOM"
      },
      "priority": {
        "interest": 99,
        "principal": 99
      },
      "type": "RESIDUAL"
    }
  ],
  "currency": "USD",
  "dates": {
    "business_day_convention": "FOLLOWING",
    "closing_date": "2024-01-30",
    "cutoff_date": "2024-01-01",
    "day_count": "30_360",
    "first_payment_date": "2024-02-25",
    "maturity_date": "2054-01-01",
    "payment_delay_days": 2,
    "payment_frequency": "MONTHLY"
  },
  "documents": [
    {
      "description": "Pooling and Servicing Agreement",
      "type": "PSA"
    },
    {
      "description": "Offering memorandum and prospectus supplement",
      "type": "Prospectus"
    }
  ],
  "fees": [
    {
      "amount_rule": "ServicingFeeAmount",
      "id": "ServicingFee",
      "pay_from_fund": "IAF",
      "seniority": 1,
      "unpaid_treatment": "CARRY"
    },
    {
      "amount_rule": "TrusteeFeeAmount",
      "id": "TrusteeFee",
      "pay_from_fund": "IAF",
      "seniority": 2,
      "unpaid_treatment": "CARRY"
    },
    {
      "amount_rule": "CustodianFeeAmount",
      "id": "CustodianFee",
      "pay_from_fund": "IAF",
      "seniority": 3,
      "unpaid_treatment": "CARRY"
    }
  ],
  "funds": [
    {
      "description": "Interest Available Funds",
      "id": "IAF"
    },
    {
      "description": "Principal Available Funds",
      "id": "PAF"
    }
  ],
  "groups": {
    "IO": [
      "ClassIO"
    ],
    "MEZZ": [
      "ClassB"
    ],
    "RESIDUAL": [
      "ClassR"
    ],
    "SENIOR": [
      "ClassA1",
      "ClassA2"
    ]
  },
  "hedges": [
    {
      "id": "Swap01",
      "notional_schedule": [
        {
          "amount": 150000000.0,
          "date": "2024-02-25"
        },
        {
          "amount": 90000000.0,
          "date": "2029-02-25"
        }
      ],
      "pay_leg": {
        "fixed_rate": 0.03,
        "kind": "FIXED"
      },
      "receive_leg": {
        "index": "SOFR_1M",
        "kind": "FLOAT",
        "margin": 0.0
      },
      "type": "SWAP"
    }
  ],
  "jurisdiction": {
    "country": "US",
    "governing_law": "New York",
    "tax_regime": "REMIC"
  },
  "ledgers": [
    {
      "id": "InterestShortfall",
      "type": "INTEREST_SHORTFALL"
    },
    {
      "id": "PDL",
      "type": "PRINCIPAL_DEFICIT"
    }
  ],
  "meta": {
    "asset_type": "NON_AGENCY_RMBS",
    "deal_id": "SAMPLE_RMBS_2024",
    "deal_name": "Freddie Mac Sample 2017-2020",
    "version": "1.1"
  },
  "options": {
    "cleanup_call": {
      "enabled": true,
      "threshold_rule": "collateral.current_balance <= 0.1 * collateral.original_balance"
    }
  },
  "parties": {
    "administrator": {
      "name": "Deal Administration Services LLC"
    },
    "issuer": {
      "lei": "5493001KJTIIGC8Y1R12",
      "name": "Sample RMBS Trust 2024-1"
    },
    "servicer": {
      "lei": "549300BN3L1KJ2ABCD34",
      "name": "Sample Servicing LLC"
    },
    "sponsor": {
      "name": "Example Mortgage Originator Inc."
    },
    "trustee": {
      "lei": "5493009ZC9TC1D2XGZ10",
      "name": "Example Trust Company"
    }
  },
  "reporting": {
    "outputs": {
      "tranche_cashflows": true
    }
  },
  "servicing": {
    "advancing": {
      "advance_limit_rule": "collateral.current_balance * 0.02",
      "advance_types": [
        "P&I",
        "Taxes",
        "Insurance"
      ],
      "enabled": true
    },
    "servicing_fee": {
      "basis": "CURRENT_BALANCE",
      "rate_bps": 25.0
    }
  },
  "tests": [
    {
      "calc": {
        "denominator_rule": "1",
        "numerator_rule": "0.045",
        "rolling_average_months": 3,
        "value_rule": "0.045"
      },
      "effects": [
        {
          "set_flag": "TurboTrigger"
        }
      ],
      "id": "DelinquencyTest",
      "kind": "DELINQ",
      "pass_if": "VALUE_LT_THRESHOLD",
      "threshold": {
        "rule": "0.06"
      }
    },
    {
      "calc": {
        "rolling_average_months": 1,
        "value_rule": "(collateral.current_balance - bonds.ClassA1.balance - bonds.ClassA2.balance) / MAX(1, bonds.ClassB.balance)"
      },
      "effects": [
        {
          "flag_value_if_pass": true,
          "set_flag": "OCTestPass"
        }
      ],
      "id": "OCTest",
      "kind": "OC",
      "pass_if": "VALUE_GEQ_THRESHOLD",
      "threshold": {
        "rule": "0.12"
      }
    },
    {
      "calc": {
        "value_rule": "funds.IAF / MAX(1, bonds.ClassA1.balance * (0.0475 / 12) + bonds.ClassA2.balance * ((0.052 + 0.0175) / 12) + bonds.ClassB.balance * (MAX(0.04, MIN(0.055, 0.08)) / 12))"
      },
      "effects": [
        {
          "flag_value_if_pass": true,
          "set_flag": "ICTestPass"
        }
      ],
      "id": "ICTest",
      "kind": "IC",
      "pass_if": "VALUE_GEQ_THRESHOLD",
      "threshold": {
        "rule": "1.15"
      }
    }
  ],
  "variables": {
    "ClassA1_IntDue": "bonds.ClassA1.balance * (0.0475 / 12)",
    "ClassA2_IntDue": "bonds.ClassA2.balance * (IndexRate + 0.0175) / 12",
    "ClassB_IntDue": "bonds.ClassB.balance * (MAX(0.04, MIN(NetWAC, 0.08)) / 12)",
    "CustodianFeeAmount": "2000",
    "IndexRate": "0.052",
    "NetWAC": "0.055",
    "PoolFactor": "collateral.current_balance / collateral.original_balance",
    "ReserveDeficit": "MAX(0, ReserveTarget - funds.RESERVE)",
    "ReserveTarget": "MAX(1250000, collateral.original_balance * 0.005)",
    "ServicingFeeAmount": "collateral.current_balance * ServicingFeeRate",
    "ServicingFeeRate": "0.0025 / 12",
    "TrusteeFeeAmount": "MAX(7500, collateral.current_balance * 0.0001 / 12)",
    "TurboTrigger": "tests.DelinquencyTest.failed or tests.OCTest.failed"
  },
  "waterfalls": {
    "interest": {
      "steps": [
        {
          "action": "PAY_FEE",
          "amount_rule": "ServicingFeeAmount",
          "from_fund": "IAF",
          "id": "I-1",
          "unpaid_ledger_id": "InterestShortfall"
        },
        {
          "action": "PAY_FEE",
          "amount_rule": "TrusteeFeeAmount",
          "from_fund": "IAF",
          "id": "I-2",
          "unpaid_ledger_id": "InterestShortfall"
        },
        {
          "action": "PAY_FEE",
          "amount_rule": "CustodianFeeAmount",
          "from_fund": "IAF",
          "id": "I-3",
          "unpaid_ledger_id": "InterestShortfall"
        },
        {
          "action": "PAY_BOND_INTEREST",
          "amount_rule": "ClassA1_IntDue",
          "from_fund": "IAF",
          "group": "ClassA1",
          "id": "I-4"
        },
        {
          "action": "PAY_BOND_INTEREST",
          "amount_rule": "ClassA2_IntDue",
          "from_fund": "IAF",
          "group": "ClassA2",
          "id": "I-5"
        },
        {
          "action": "TRANSFER_FUND",
          "amount_rule": "MIN(funds.IAF, ReserveDeficit)",
          "from_fund": "IAF",
          "id": "I-6",
          "to": "RESERVE"
        },
        {
          "action": "PAY_BOND_INTEREST",
          "amount_rule": "ClassB_IntDue",
          "condition": "TurboTrigger == False",
          "from_fund": "IAF",
          "group": "ClassB",
          "id": "I-7"
        },
        {
          "action": "TRANSFER_FUND",
          "amount_rule": "REMAINING",
          "from_fund": "IAF",
          "id": "I-8",
          "to": "PAF"
        }
      ]
    },
    "loss_allocation": {
      "loss_source_rule": "RealizedLoss",
      "write_down_order": [
        "ClassR",
        "ClassB",
        "ClassA2",
        "ClassA1"
      ],
      "write_down_style": "REDUCE_BALANCE"
    },
    "principal": {
      "steps": [
        {
          "action": "PAY_BOND_PRINCIPAL",
          "amount_rule": "ALL",
          "from_fund": "PAF",
          "group": "ClassA1",
          "id": "P-1"
        },
        {
          "action": "PAY_BOND_PRINCIPAL",
          "amount_rule": "ALL",
          "from_fund": "PAF",
          "group": "ClassA2",
          "id": "P-2"
        },
        {
          "action": "PAY_BOND_PRINCIPAL",
          "amount_rule": "ALL",
          "from_fund": "PAF",
          "group": "ClassB",
          "id": "P-3"
        },
        {
          "action": "PAY_BOND_PRINCIPAL",
          "amount_rule": "REMAINING",
          "from_fund": "PAF",
          "group": "ClassR",
          "id": "P-4"
        }
      ]
    }
  }
}